<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MLIR: lib/Analysis/Presburger/PresburgerRelation.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">MLIR<span id="projectnumber">&#160;22.0.0git</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search',false);
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a href="dir_a25db018342d3ae6c7e6779086c18378.html">Analysis</a></li><li class="navelem"><a href="dir_3368c93b35f7d7185bde93ea86c513e2.html">Presburger</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">PresburgerRelation.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="PresburgerRelation_8h_source.html">mlir/Analysis/Presburger/PresburgerRelation.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="IntegerRelation_8h_source.html">mlir/Analysis/Presburger/IntegerRelation.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="PWMAFunction_8h_source.html">mlir/Analysis/Presburger/PWMAFunction.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="PresburgerSpace_8h_source.html">mlir/Analysis/Presburger/PresburgerSpace.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Simplex_8h_source.html">mlir/Analysis/Presburger/Simplex.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Analysis_2Presburger_2Utils_8h_source.html">mlir/Analysis/Presburger/Utils.h</a>&quot;</code><br />
<code>#include &quot;llvm/ADT/STLExtras.h&quot;</code><br />
<code>#include &quot;llvm/ADT/SmallBitVector.h&quot;</code><br />
<code>#include &quot;llvm/ADT/SmallVector.h&quot;</code><br />
<code>#include &quot;llvm/Support/raw_ostream.h&quot;</code><br />
<code>#include &lt;cassert&gt;</code><br />
<code>#include &lt;functional&gt;</code><br />
<code>#include &lt;optional&gt;</code><br />
<code>#include &lt;utility&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
</div>
<p><a href="PresburgerRelation_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-nested-classes" class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:mlir_3A_3Apresburger_3A_3ASetCoalescer" id="r_mlir_3A_3Apresburger_3A_3ASetCoalescer"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpresburger_1_1SetCoalescer.html">mlir::presburger::SetCoalescer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The SetCoalescer class contains all functionality concerning the coalesce heuristic.  <a href="classpresburger_1_1SetCoalescer.html#details">More...</a><br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a233868d32864097ce2a5925652cc462c" id="r_a233868d32864097ce2a5925652cc462c"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structmlir_1_1presburger_1_1SymbolicLexOpt.html">SymbolicLexOpt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a233868d32864097ce2a5925652cc462c">findSymbolicIntegerLexOpt</a> (const <a class="el" href="classmlir_1_1presburger_1_1PresburgerRelation.html">PresburgerRelation</a> &amp;rel, <a class="el" href="classbool.html">bool</a> isMin)</td></tr>
<tr class="memitem:abd08e6c996e93d7ea7409565e321b5b9" id="r_abd08e6c996e93d7ea7409565e321b5b9"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classllvm_1_1SmallVector.html">SmallVector</a>&lt; DynamicAPInt, 8 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abd08e6c996e93d7ea7409565e321b5b9">getIneqCoeffsFromIdx</a> (const <a class="el" href="classmlir_1_1presburger_1_1IntegerRelation.html">IntegerRelation</a> &amp;rel, <a class="el" href="classunsigned.html">unsigned</a> idx)</td></tr>
<tr class="memdesc:abd08e6c996e93d7ea7409565e321b5b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the coefficients of the ineq in <span class="tt">rel</span> specified by <span class="tt">idx</span>.  <br /></td></tr>
<tr class="memitem:ad326b29ae44e4866048ec9123cf3d9d5" id="r_ad326b29ae44e4866048ec9123cf3d9d5"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classmlir_1_1presburger_1_1PresburgerRelation.html">PresburgerRelation</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad326b29ae44e4866048ec9123cf3d9d5">getSetDifference</a> (<a class="el" href="classmlir_1_1presburger_1_1IntegerRelation.html">IntegerRelation</a> <a class="el" href="LinalgTransformOps_8cpp.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a>, const <a class="el" href="classmlir_1_1presburger_1_1PresburgerRelation.html">PresburgerRelation</a> &amp;s)</td></tr>
<tr class="memdesc:ad326b29ae44e4866048ec9123cf3d9d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the set difference b \ s.  <br /></td></tr>
</table>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="a233868d32864097ce2a5925652cc462c" name="a233868d32864097ce2a5925652cc462c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a233868d32864097ce2a5925652cc462c">&#9670;&#160;</a></span>findSymbolicIntegerLexOpt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmlir_1_1presburger_1_1SymbolicLexOpt.html">SymbolicLexOpt</a> findSymbolicIntegerLexOpt </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmlir_1_1presburger_1_1PresburgerRelation.html">PresburgerRelation</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>rel</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a></td>          <td class="paramname"><span class="paramname"><em>isMin</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PresburgerRelation_8cpp_source.html#l00245">245</a> of file <a class="el" href="PresburgerRelation_8cpp_source.html">PresburgerRelation.cpp</a>.</p>

<p class="reference">References <a class="el" href="PresburgerRelation_8cpp_source.html#l00068">mlir::presburger::PresburgerRelation::getAllDisjuncts()</a>, <a class="el" href="PresburgerRelation_8h_source.html#l00057">mlir::presburger::PresburgerRelation::getSpace()</a>, <a class="el" href="PresburgerRelation_8cpp_source.html#l01081">mlir::presburger::PresburgerSet::intersect()</a>, <a class="el" href="Simplex_8h_source.html#l00537">mlir::presburger::SymbolicLexOpt::lexopt</a>, <a class="el" href="LinalgTransformOps_8cpp_source.html#l02098">result</a>, <a class="el" href="Simplex_8h_source.html#l00541">mlir::presburger::SymbolicLexOpt::unboundedDomain</a>, <a class="el" href="PWMAFunction_8cpp_source.html#l00383">mlir::presburger::PWMAFunction::unionLexMax()</a>, and <a class="el" href="PWMAFunction_8cpp_source.html#l00379">mlir::presburger::PWMAFunction::unionLexMin()</a>.</p>

<p class="reference">Referenced by <a class="el" href="PresburgerRelation_8cpp_source.html#l00268">mlir::presburger::PresburgerRelation::findSymbolicIntegerLexMax()</a>, and <a class="el" href="PresburgerRelation_8cpp_source.html#l00264">mlir::presburger::PresburgerRelation::findSymbolicIntegerLexMin()</a>.</p>

</div>
</div>
<a id="abd08e6c996e93d7ea7409565e321b5b9" name="abd08e6c996e93d7ea7409565e321b5b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd08e6c996e93d7ea7409565e321b5b9">&#9670;&#160;</a></span>getIneqCoeffsFromIdx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classllvm_1_1SmallVector.html">SmallVector</a>&lt; DynamicAPInt, 8 &gt; getIneqCoeffsFromIdx </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmlir_1_1presburger_1_1IntegerRelation.html">IntegerRelation</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>rel</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classunsigned.html">unsigned</a></td>          <td class="paramname"><span class="paramname"><em>idx</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the coefficients of the ineq in <span class="tt">rel</span> specified by <span class="tt">idx</span>. </p>
<p><span class="tt">idx</span> can refer not only to an actual inequality of <span class="tt">rel</span>, but also to either of the inequalities that make up an equality in <span class="tt">rel</span>.</p>
<p>When 0 &lt;= idx &lt; rel.getNumInequalities(), this returns the coeffs of the idx-th inequality of <span class="tt">rel</span>.</p>
<p>Otherwise, it is then considered to index into the ineqs corresponding to eqs of <span class="tt">rel</span>, and it must hold that</p>
<p>0 &lt;= idx - rel.getNumInequalities() &lt; 2*getNumEqualities().</p>
<p>For every eq <span class="tt">coeffs == 0</span> there are two possible ineqs to index into. The first is coeffs &gt;= 0 and the second is coeffs &lt;= 0. </p>

<p class="definition">Definition at line <a class="el" href="PresburgerRelation_8cpp_source.html#l00287">287</a> of file <a class="el" href="PresburgerRelation_8cpp_source.html">PresburgerRelation.cpp</a>.</p>

<p class="reference">References <a class="el" href="IntegerRelation_8h_source.html#l00254">mlir::presburger::IntegerRelation::getEquality()</a>, <a class="el" href="IntegerRelation_8h_source.html#l00257">mlir::presburger::IntegerRelation::getInequality()</a>, <a class="el" href="Analysis_2Presburger_2Utils_8cpp_source.html#l00371">mlir::presburger::getNegatedCoeffs()</a>, <a class="el" href="IntegerRelation_8h_source.html#l00240">mlir::presburger::IntegerRelation::getNumEqualities()</a>, and <a class="el" href="IntegerRelation_8h_source.html#l00242">mlir::presburger::IntegerRelation::getNumInequalities()</a>.</p>

<p class="reference">Referenced by <a class="el" href="PresburgerRelation_8cpp_source.html#l00344">getSetDifference()</a>.</p>

</div>
</div>
<a id="ad326b29ae44e4866048ec9123cf3d9d5" name="ad326b29ae44e4866048ec9123cf3d9d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad326b29ae44e4866048ec9123cf3d9d5">&#9670;&#160;</a></span>getSetDifference()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmlir_1_1presburger_1_1PresburgerRelation.html">PresburgerRelation</a> getSetDifference </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmlir_1_1presburger_1_1IntegerRelation.html">IntegerRelation</a></td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classmlir_1_1presburger_1_1PresburgerRelation.html">PresburgerRelation</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>s</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the set difference b \ s. </p>
<p>In the following, U denotes union, /\ denotes intersection, \ denotes set difference and ~ denotes complement.</p>
<p>Let s = (U_i s_i). We want b \ (U_i s_i).</p>
<p>Let s_i = /_j s_ij, where each s_ij is a single inequality. To compute b \ s_i = b /\ ~s_i, we partition s_i based on the first violated inequality: ~s_i = (~s_i1) U (s_i1 /\ ~s_i2) U (s_i1 /\ s_i2 /\ ~s_i3) U ... And the required result is (b /\ ~s_i1) U (b /\ s_i1 /\ ~s_i2) U ... We recurse by subtracting U_{j &gt; i} S_j from each of these parts and returning the union of the results. Each equality is handled as a conjunction of two inequalities.</p>
<p>Note that the same approach works even if an inequality involves a floor division. For example, the complement of x &lt;= 7*floor(x/7) is still x &gt; 7*floor(x/7). Since b \ s_i contains the inequalities of both b and s_i (or the complements of those inequalities), b \ s_i may contain the divisions present in both b and s_i. Therefore, we need to add the local division variables of both b and s_i to each part in the result. This means adding the local variables of both b and s_i, as well as the corresponding division inequalities to each part. Since the division inequalities are added to each part, we can skip the parts where the complement of any division inequality is added, as these parts will become empty anyway.</p>
<p>As a heuristic, we try adding all the constraints and check if simplex says that the intersection is empty. If it is, then subtracting this disjuncts is a no-op and we just skip it. Also, in the process we find out that some constraints are redundant. These redundant constraints are ignored. </p>

<p class="definition">Definition at line <a class="el" href="PresburgerRelation_8cpp_source.html#l00344">344</a> of file <a class="el" href="PresburgerRelation_8cpp_source.html">PresburgerRelation.cpp</a>.</p>

<p class="reference">References <a class="el" href="Simplex_8cpp_source.html#l01109">mlir::presburger::Simplex::addInequality()</a>, <a class="el" href="Simplex_8cpp_source.html#l01320">mlir::presburger::SimplexBase::appendVariable()</a>, <a class="el" href="LinalgTransformOps_8cpp_source.html#l02097">b</a>, <a class="el" href="PresburgerRelation_8cpp_source.html#l00301">mlir::presburger::PresburgerRelation::computeReprWithOnlyDivLocals()</a>, <a class="el" href="Simplex_8cpp_source.html#l01428">mlir::presburger::Simplex::detectRedundant()</a>, <a class="el" href="Analysis_2Presburger_2Utils_8h_source.html#l00090">mlir::presburger::Equality</a>, <a class="el" href="Analysis_2Presburger_2Utils_8cpp_source.html#l00380">mlir::presburger::getComplementIneq()</a>, <a class="el" href="Analysis_2Presburger_2Utils_8h_source.html#l00153">mlir::presburger::DivisionRepr::getDenom()</a>, <a class="el" href="PresburgerRelation_8cpp_source.html#l00072">mlir::presburger::PresburgerRelation::getDisjunct()</a>, <a class="el" href="Analysis_2Presburger_2Utils_8h_source.html#l00139">mlir::presburger::DivisionRepr::getDividend()</a>, <a class="el" href="Analysis_2Presburger_2Utils_8cpp_source.html#l00327">mlir::presburger::getDivLowerBound()</a>, <a class="el" href="Analysis_2Presburger_2Utils_8cpp_source.html#l00315">mlir::presburger::getDivUpperBound()</a>, <a class="el" href="PresburgerRelation_8cpp_source.html#l00135">mlir::presburger::PresburgerRelation::getEmpty()</a>, <a class="el" href="PresburgerRelation_8cpp_source.html#l00287">getIneqCoeffsFromIdx()</a>, <a class="el" href="IntegerRelation_8h_source.html#l00257">mlir::presburger::IntegerRelation::getInequality()</a>, <a class="el" href="IntegerRelation_8cpp_source.html#l01023">mlir::presburger::IntegerRelation::getLocalReprs()</a>, <a class="el" href="Simplex_8cpp_source.html#l01132">mlir::presburger::SimplexBase::getNumConstraints()</a>, <a class="el" href="PresburgerRelation_8cpp_source.html#l00064">mlir::presburger::PresburgerRelation::getNumDisjuncts()</a>, <a class="el" href="IntegerRelation_8h_source.html#l00240">mlir::presburger::IntegerRelation::getNumEqualities()</a>, <a class="el" href="IntegerRelation_8h_source.html#l00242">mlir::presburger::IntegerRelation::getNumInequalities()</a>, <a class="el" href="IntegerRelation_8h_source.html#l00229">mlir::presburger::IntegerRelation::getNumLocalVars()</a>, <a class="el" href="PresburgerSpace_8h_source.html#l00189">mlir::presburger::PresburgerSpace::getNumLocalVars()</a>, <a class="el" href="PresburgerRelation_8cpp_source.html#l00344">getSetDifference()</a>, <a class="el" href="Simplex_8cpp_source.html#l01136">mlir::presburger::SimplexBase::getSnapshot()</a>, <a class="el" href="IntegerRelation_8h_source.html#l00316">mlir::presburger::IntegerRelation::CountsSnapshot::getSpace()</a>, <a class="el" href="PresburgerRelation_8h_source.html#l00057">mlir::presburger::PresburgerRelation::getSpace()</a>, <a class="el" href="IntegerRelation_8h_source.html#l00277">mlir::presburger::IntegerRelation::getVarKindOffset()</a>, <a class="el" href="PresburgerRelation_8cpp_source.html#l01028">mlir::presburger::PresburgerRelation::hasOnlyDivLocals()</a>, <a class="el" href="Analysis_2Presburger_2Utils_8h_source.html#l00090">mlir::presburger::Inequality</a>, <a class="el" href="Simplex_8cpp_source.html#l01335">mlir::presburger::SimplexBase::intersectIntegerRelation()</a>, <a class="el" href="Simplex_8cpp_source.html#l01069">mlir::presburger::SimplexBase::isEmpty()</a>, <a class="el" href="Simplex_8cpp_source.html#l01408">mlir::presburger::Simplex::isMarkedRedundant()</a>, <a class="el" href="PresburgerSpace_8h_source.html#l00031">mlir::presburger::Local</a>, <a class="el" href="IntegerRelation_8cpp_source.html#l01408">mlir::presburger::IntegerRelation::removeDuplicateDivs()</a>, <a class="el" href="LinalgTransformOps_8cpp_source.html#l02098">result</a>, and <a class="el" href="Simplex_8cpp_source.html#l01290">mlir::presburger::SimplexBase::rollback()</a>.</p>

<p class="reference">Referenced by <a class="el" href="PresburgerRelation_8cpp_source.html#l00597">mlir::presburger::PresburgerRelation::complement()</a>, <a class="el" href="PresburgerRelation_8cpp_source.html#l00344">getSetDifference()</a>, and <a class="el" href="PresburgerRelation_8cpp_source.html#l00604">mlir::presburger::PresburgerRelation::subtract()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on <span class="timestamp"></span> for MLIR by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
